<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang="it" data-ng-app="materialAdmin" data-ng-controller="materialadminCtrl as mactrl">
	<head>
		<title>Dipendente {{dipendente.nome}} {{dipendente.cognome}}</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />


<!--==================================================================================================-->
    <!-- Vendor CSS -->
    <link href="{{url_for('static', filename='headerAndForm/vendors/bower_components/animate.css/animate.min.css') }}" rel="stylesheet">
    <link href="{{url_for('static', filename='headerAndForm/vendors/bower_components/material-design-iconic-font/dist/css/material-design-iconic-font.min.css') }}" rel="stylesheet">
    <link href="{{url_for('static', filename='headerAndForm/vendors/bower_components/angular-loading-bar/src/loading-bar.css') }}" rel="stylesheet">


    <!-- CSS -->
    <link href="{{url_for('static', filename='headerAndForm/css/app.css') }}" rel="stylesheet">
    <link href="{{url_for('static', filename='headerAndForm/css/demo.css') }}" rel="stylesheet">


<!--=================================================================================================-->

    <link href="{{url_for('static', filename='bootstrap/css/normalize.css') }}" rel="stylesheet">
    <link rel="stylesheet" href="{{url_for('static', filename='css/font-awesome.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="{{url_for('static', filename='bootstrap/css/bootstrap.min.css') }}" rel="stylesheet">

<!--==================== css form registrazione e profilo =============================================-->

    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='form/fonts/iconic/css/material-design-iconic-font.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='form/vendor/animate/animate.css') }}">
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='form/vendor/css-hamburgers/hamburgers.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='form/vendor/animsition/css/animsition.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='form/vendor/select2/select2.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='form/vendor/daterangepicker/daterangepicker.css') }}">
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='form/vendor/noui/nouislider.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='form/css/util.css') }}">

    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='form/css/main.css') }}">
<!--===============================================================================================-->

    <link rel="stylesheet" href="{{url_for('static', filename='css/gestioneDip.css') }}">
    <link rel="stylesheet" href="{{url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{url_for('static', filename='css/registraDipendente.css') }}">
    <link rel="stylesheet" href="{{url_for('static', filename='css/profiloDip.css') }}">
    <link rel="stylesheet" href="{{url_for('static', filename='css/button-modificaProfilo.css') }}">

<!--==================== css calendario e agenda====== =============================================-->
    <link href="{{url_for('static', filename='agenda/fullcalendar.min.css') }}" rel='stylesheet' />
    <link href="{{url_for('static', filename='agenda/fullcalendar.print.min.css') }}" rel='stylesheet' media='print' />

    <script src="{{url_for('static', filename='js/vendor/jquery-1.10.2.min.js') }}"></script>

    <script src="{{url_for('static', filename='agenda/lib/moment.min.js') }}"></script>
    <script src="{{url_for('static', filename='agenda/fullcalendar.min.js') }}"></script>
    <script src="{{url_for('static', filename='agenda/locale/it.js') }}"></script>
<!--===============================================================================================-->

    <link href="{{url_for('static', filename='headerAndForm/vendors/bower_components/bootstrap-sweetalert/lib/sweet-alert.css') }}" rel='stylesheet' />
    <script src="{{url_for('static', filename='js/vendor/sweet-alert2.min.js') }}"></script>

<!--===============================favicons =========================================================-->


    <link rel="apple-touch-icon" sizes="57x57" href="{{url_for('static', filename='favicon/apple-icon-57x57.png') }}">
    <link rel="apple-touch-icon" sizes="60x60" href="{{url_for('static', filename='favicon/apple-icon-60x60.png') }}">
    <link rel="apple-touch-icon" sizes="72x72" href="{{url_for('static', filename='favicon/apple-icon-72x72.png') }}">
    <link rel="apple-touch-icon" sizes="76x76" href="{{url_for('static', filename='favicon/apple-icon-76x76.png') }}">
    <link rel="apple-touch-icon" sizes="114x114" href="{{url_for('static', filename='favicon/apple-icon-114x114.png') }}">
    <link rel="apple-touch-icon" sizes="120x120" href="{{url_for('static', filename='favicon/apple-icon-120x120.png') }}">
    <link rel="apple-touch-icon" sizes="144x144" href="{{url_for('static', filename='favicon/apple-icon-144x144.png') }}">
    <link rel="apple-touch-icon" sizes="152x152" href="{{url_for('static', filename='favicon/apple-icon-152x152.png') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{url_for('static', filename='favicon/apple-icon-180x180.png') }}">
    <link rel="icon" type="image/png" sizes="192x192"  href="{{url_for('static', filename='favicon/android-icon-192x192.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{url_for('static', filename='favicon/favicon-32x32.png') }}">
    <link rel="icon" type="image/png" sizes="96x96" href="{{url_for('static', filename='favicon/favicon-96x96.png') }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{url_for('static', filename='favicon/favicon-16x16.png') }}">
    <link rel="manifest" href="{{url_for('static', filename='favicon/manifest.json') }}">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="{{url_for('static', filename='favicon/ms-icon-144x144.png') }}">
    <meta name="theme-color" content="#ffffff">

<!--===================================socket io====================================================-->
    <script src="{{url_for('static', filename='js/vendor/socket.io.js') }}"></script>
    <!--===========================================================================================================-->

        <!-- Angular -->
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/angular/angular.min.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/angular-animate/angular-animate.min.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/angular-resource/angular-resource.min.js') }}"></script>

        <!-- Angular Modules -->
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/angular-ui-router/release/angular-ui-router.min.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/angular-loading-bar/src/loading-bar.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/oclazyload/dist/ocLazyLoad.min.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js') }}"></script>

        <!-- Common Vendors -->
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/jquery.nicescroll/jquery.nicescroll.min.js') }}"></script>

        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/Waves/dist/waves.min.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bootstrap-growl/bootstrap-growl.min.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/ng-table/dist/ng-table.min.js') }}"></script>



        <!-- Using below vendors in order to avoid misloading on resolve -->
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/flot/jquery.flot.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/flot.curvedlines/curvedLines.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/flot/jquery.flot.resize.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/moment/min/moment.min.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/fullcalendar/dist/fullcalendar.min.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/flot-orderBars/js/jquery.flot.orderBars.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/flot/jquery.flot.pie.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/flot.tooltip/js/jquery.flot.tooltip.min.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/vendors/bower_components/angular-nouislider/src/nouislider.min.js') }}"></script>

        <!-- App level -->
        <script src="{{url_for('static', filename='headerAndForm/js/app.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/config.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/controllers/main.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/services.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/templates.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/controllers/ui-bootstrap.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/controllers/table.js') }}"></script>


        <!-- Template Modules -->
        <script src="{{url_for('static', filename='headerAndForm/js/modules/template.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/modules/ui.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/modules/charts/flot.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/modules/charts/other-charts.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/modules/form.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/modules/media.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/modules/components.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/modules/calendar.js') }}"></script>
        <script src="{{url_for('static', filename='headerAndForm/js/modules/demo.js') }}"></script>

<!--===========================================================================================================-->




		<!--[if lte IE 8]><script src="{{url_for('static', filename='paginaCliente/assets/js/ie/html5shiv.js') }}"></script><![endif]-->
		<link rel="stylesheet" href="{{url_for('static', filename='paginaCliente/assets/css/main.css') }}" />
		<!--[if lte IE 9]><link rel="stylesheet" href="{{url_for('static', filename='paginaCliente/assets/css/ie9.css') }}" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="{{url_for('static', filename='paginaCliente/assets/css/ie8.css') }}" /><![endif]-->


        <link rel="stylesheet" href="{{url_for('static', filename='calendario/css/bootstrap-year-calendar.css') }}">
        <script src="{{url_for('static', filename='calendario/js/bootstrap-year-calendar.js') }}"></script>

        <link rel="stylesheet" href="{{url_for('static', filename='swal-forms/swal-forms.css') }}">
        <link rel="stylesheet" href="{{url_for('static', filename='swal-forms/sweet-alert.css') }}">
        <script src="{{url_for('static', filename='swal-forms/sweet-alert.js') }}"></script>
        <script src="{{url_for('static', filename='swal-forms/swal-forms.js') }}"></script>

        <link rel="stylesheet" href="{{url_for('static', filename='css/popover-paginaProfilo.css') }}">
        <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='hunterPopup/css/hunterPopup.css')}}">
        <script type="text/javascript" src="{{url_for('static', filename='hunterPopup/js/jquery-popup.js')}}"></script>

	</head>
	<body data-ng-class="{ 'sw-toggled': mactrl.layoutType === '1', 'modal-open': mactrl.sidebarToggle.left === true }">


	<header id="header" data-ng-include="'header'" data-ng-controller="headerCtrl as hctrl"></header>
    <aside id="sidebar" data-ng-include="'sidebarLeft'" data-ng-class="{ 'toggled': mactrl.sidebarToggle.left === true }"></aside>

	<aside id="chat" data-ng-include="'/static/headerAndForm/template/chat.html'" data-ng-class="{ 'toggled': mactrl.sidebarToggle.right === true }"></aside>


	<div class="row">


		<!-- Sidebar -->
			<div class="col-md-3">
			<section id="sidebar-client">
				<div class="inner">
					<nav>
						<ul>
							<li><a class="menuBar local" href="#intro">Profilo personale</a></li>
                            <li><a class="menuBar local" href="#page2">Imposta ferie</a></li>
                        </ul>

					</nav>
				</div>
			</section>
			</div>

		<!-- Wrapper -->
			<div id="wrapper" class="col-md-9">

				<!-- Intro -->
					<section id="intro" class="wrapper style1 fullscreen fade-up black-background">
                         <div id="datiPersonali">
                             <div id="imgDiv">

                                 <div id="changeImgProfiloDiv">
                                     <form id="uploadImgForm" action="/uploadImgProfilo" method="post" enctype="multipart/form-data" >
                                            <input id="uploadImg" type="file" name="image">

                                     </form>
                                     <button id="changeImgProfiloBtn" style="display:none" onclick="$('#uploadImg').trigger('click');">Cambia immagine profilo</button>
                                 </div>
                                 <img src="{{url_for('static', filename='immaginiProfilo/'+dipendente.immagine_profilo ) }}" alt="">

                             </div>

                             <div id="right-info">

                                 <span id="name_container">
                                     <h1>{{dipendente.nome}}</h1>
                                     <h1 id="cognome">{{dipendente.cognome}}</h1>
                                     <a class="fa fa-edit editProfilo nome_cognome"></a>
                                 </span><br/>
                                 <span id="classe_dip">{{dipendente.classe}}</span>

                                 <div id="dati-effettivi" class="row">
                                     <div class="col-md-6">
                                         <span class="dato"><h3>Codice fiscale:<a class="fa fa-edit editProfilo cf"></a></h3><span id="cf">{{dipendente.cf}}</span></span><br/>
                                         <span class="dato"><h3>Data di nascita:<a class="fa fa-edit editProfilo nascita"></a></h3><span id="nascita">{{dipendente.dataNascita}}</span></span><br/>
                                         <span class="dato"><h3>Indirizzo residenza:<a class="fa fa-edit editProfilo residenza"></a></h3><span id="residenza">{{dipendente.residenzaVia}} n.{{dipendente.residenzaNum}}, {{dipendente.residenzaCitta}}, {{dipendente.residenzaRegione}}</span></span><br/>
                                         <span class="dato"><h3>Indirizzo domicilio:<a class="fa fa-edit editProfilo domicilio"></a></h3><span id="domicilio">{{dipendente.domicilioVia}} n.{{dipendente.domicilioNum}}, {{dipendente.domicilioCitta}}, {{dipendente.domicilioRegione}}</span></span><br/>
                                         <span class="dato"><h3>Telefono:<a class="fa fa-edit editProfilo telefono"></a></h3><span id="telefono">{{dipendente.telefono}}</span></span><br/>
                                     </div>
                                     <div class="col-md-6">
                                         <span class="dato"><h3>Email personale:<a class="fa fa-edit editProfilo email_personale"></a></h3><span id="email_personale">{{dipendente.email_personale}}</span></span><br/>
                                         <span class="dato"><h3>Email aziendale:<a class="fa fa-edit editProfilo email_aziendale"></a></h3><span id="email_aziendale">{{dipendente.email_aziendale}}</span></span><br/>
                                         <span class="dato"><h3>Iban:<a class="fa fa-edit editProfilo iban"></a></h3><span id="iban">{{dipendente.iban}}</span></span><br/>
                                         <span class="dato"><h3>Partiva IVA:<a class="fa fa-edit editProfilo iva"></a></h3><span id="iva">{{dipendente.partitaIva}}</span></span><br/>

                                     </div>
                                 </div>
                                 <div id="buttons-edit">
                                     <a class="fa fa-edit" id="show-buttons"></a>
                                     <button id="edit-credenziali" style="display:none">Modifica credenziali d'accesso</button>
                                     <button id="hide-edit" style="display:none">Congela modifiche</button>

                                 </div>
                             </div>
                         </div>

					</section>
                    <section id="page2" class="wrapper style1 fullscreen fade-up agenda-ferie">
                        <span><h2>Calendario ferie</h2></span>
                        <div id='calendar'></div>

                    </section>


			</div>

		<!-- Scripts -->
		<!--================================= JS Form =================================================================-->
		<script src="{{url_for('static', filename='form/vendor/animsition/js/animsition.min.js') }}"></script>
		<script src="{{url_for('static', filename='form/vendor/bootstrap/js/popper.js') }}"></script>
		<script src="{{url_for('static', filename='bootstrap/js/bootstrap.min.js') }}"></script>
		<script src="{{url_for('static', filename='form/vendor/select2/select2.min.js') }}"></script>
		<!--===========================================================================================================-->
		<!--
		<script src="{{url_for('static', filename='paginaCliente/assets/js/jquery.min.js') }}"></script> -->
		<script src="{{url_for('static', filename='paginaCliente/assets/js/jquery.scrollex.min.js') }}"></script>
		<script src="{{url_for('static', filename='paginaCliente/assets/js/jquery.scrolly.min.js') }}"></script>
		<script src="{{url_for('static', filename='paginaCliente/assets/js/skel.min.js') }}"></script>
		<script src="{{url_for('static', filename='paginaCliente/assets/js/util.js') }}"></script>
		<!--[if lte IE 8]><script src="{{url_for('static', filename='paginaCliente/assets/js/ie/respond.min.js') }}"></script><![endif]-->
		<script src="{{url_for('static', filename='paginaCliente/assets/js/main.js') }}"></script>

		<script>

            $('#show-buttons').click(function(){
                $(this).hide();
                $('.dato a').show();
		        $('#name_container a').show();
		        $('#hide-edit').show();
		        $('#edit-credenziali').show();
                $('#changeImgProfiloBtn').show();
                $('#imgDiv').css('margin-top', '-6%');
            });


		    $('#hide-edit').click(function(){
		        $('.dato a').hide();
		        $('#name_container a').hide();
		        $('#edit-credenziali').hide();
		         $('#changeImgProfiloBtn').hide();
		        $(this).hide();
		        $('#show-buttons').show();
		        $('#imgDiv').css('margin-top', '0');
		    });

            var socketProfilo = io.connect("{{sockUrl}}"+'/profilo');

            var socketHome = io.connect("{{sockUrl}}"+'/home');

            socketHome.on('connect', function() {

                socketHome.emit('registra_sid',   {'username': '{{dipendente.username}}'} );
            });

			$('#header > a').css('border-bottom', 'None' );
			$('#uploadImg').change(function(){
                $('#uploadImgForm').submit()


			});

			function saveEvent(e, titolo) {

                //var end_date = moment(e.date).add(durata-1, 'd').toDate();

                var dataSource = $('#calendar').data('calendar').getDataSource();
                dataSource.push({startDate: e.startDate, endDate: e.endDate, name: titolo, dipendente: '{{dipendente.username}}' })
                $('#calendar').data('calendar').setDataSource(dataSource);

                socketProfilo.emit('aggiungi_ferie', {
                    'dip': '{{dipendente.username}}',
                    'titolo': titolo,
                    'start_date': e.startDate, //moment(e.date).add(1, 'd').toDate(),
                    'end_date': e.endDate, //moment(end_date).add(1, 'd').toDate()
                });

            }

            var currentYear = new Date().getFullYear();

            var modificaFerieAttiva = false;
            var eliminaFerieAttiva = false;

            delEditStartDate='';
            delEditEndDate='';
            delEditTitoloFerie='';

			$('#calendar').calendar(

              {
                 enableContextMenu: true,
                 enableRangeSelection: true,
                 language: 'it',

                dataSource: [
                   {% for evento in calendario %}
                    {% if not evento.tipologia %}
                       {


                           name: '{{evento.titolo}}',
                           location: '',
                           startDate: moment('{{evento.start_date}}').toDate(),
                           endDate: moment('{{evento.end_date}}').toDate(),
                           dipendente: '{{evento.dipendente}}'
                       },
                    {% endif %}
                   {% endfor %}

                ],

                mouseOnDay: function(e) {


                     if(e.events.length > 0) {

                         $('#popupEvent-year-cal').remove();

                         var content = '';

                         for(var i in e.events) {

                            {% for dip in dipendenti %}

                                if( '{{dip.username}}' == e.events[i].dipendente ){
                                     monthStartDate=e.events[i].startDate.getMonth()+1;
                                     var startDate = e.events[i].startDate.getDate()+"/"+ monthStartDate+"/"+e.events[i].startDate.getFullYear();

                                     monthEndDate=e.events[i].endDate.getMonth()+1;
                                     var endDate = e.events[i].endDate.getDate()+"/"+ monthEndDate+"/"+e.events[i].endDate.getFullYear();

                                     content += '<div class="panel-heading subtitle"> {{dip.nome}} {{dip.cognome}}'+
                                                    '<div class="popup-ctrl-btns '+ startDate +' '+ endDate +'"><button class="modificaBtn">Modifica</button><button class="eliminaBtn">Elimina</button></div> \
                                                 </div> \
                                                 <div class="panel-body form-inline dept1">'
                                                 +e.events[i].name+
                                                 '</div>';
                                 }

                             {% endfor %}
                         }



                         $('body').append(
                            '<div id="popupEvent-year-cal" style="display:none"> \
                                <div> \
                                    <div class="panel panel-default">'+
                                     content +
                                    '</div> \
                                </div> \
                            </div>'
                         );

                         var popupEvent = function() {

                            $('.popup-ctrl-btns').each(function(){
                                var startDate=$(this).attr('class').split(' ')[1];
                                var endDate=$(this).attr('class').split(' ')[2];
                                var titoloFerie=$(this).parent().next().text();

                                delEditStartDate=startDate;
                                delEditEndDate=endDate;
                                delEditTitoloFerie=titoloFerie;

                                $(this).children('.modificaBtn').click(function(){

                                    swal.withFormAsync({
                                        title: 'Modifica descrizione ferie dal '+ startDate +' al '+endDate,
                                        showCancelButton: true,
                                        confirmButtonColor: '#DD6B55',
                                        confirmButtonText: 'Ok',
                                        cancelButtonText: 'annulla',
                                        closeOnConfirm: true,
                                        formFields: [

                                            { id: 'titolo', label: 'Descrizione tipologia ferie (opzionale):', name: 'titolo', placeholder: 'descrizione ferie' },


                                        ]
                                    }).then(function (context) {

                                        if(context._isConfirm){


                                            socketProfilo.emit('modifica_ferie', {
                                                    'dip': '{{dipendente.username}}',
                                                    'oldTitolo': titoloFerie,
                                                    'newTitolo': context.swalForm['titolo'],
                                                    'start_date': startDate,

                                            });

                                            modificaFerieAttiva=true;


                                        }

                                    });
                                });


                                $(this).children('.eliminaBtn').click(function(){

                                    swal({
                                        title: 'Confermare cancellazione ferie dal '+  startDate +' al '+ endDate,
                                        showCancelButton: true,
                                        confirmButtonColor: '#DD6B55',
                                        confirmButtonText: 'Ok',
                                        cancelButtonText: 'annulla',
                                        closeOnConfirm: true,

                                    },
                                    function (isConfirm) {
                                        if(isConfirm){

                                               socketProfilo.emit('elimina_ferie', {
                                                    'dip': '{{dipendente.username}}',
                                                    'titolo': titoloFerie,
                                                    'start_date': startDate,

                                               });

                                               eliminaFerieAttiva=true;

                                        }

                                    });

                                });

                            });

                         }

                         monthToday=e.date.getMonth()+1;
                         var today = e.date.getDate()+"/"+ monthToday+"/"+e.date.getFullYear();

                         popPosition = "left";

                         if( monthToday == 5 || monthToday == 6 ||
                                monthToday == 11 || monthToday == 12 )
                                popPosition = "right";

                         $(e.element).hunterPopup({

                            width: '320px',
                            height: '200px',
                            title: "Dipendenti in ferie giorno: "+ today,
                            content: $('#popupEvent-year-cal'),
                            placement: popPosition,
                            event: popupEvent

                         });

                         $(e.element).trigger('launch-popup-overYear');


                     }

                 },
                 mouseOutDay: function(e) {
                    if (!$('.Hunter-pop-up:hover').length != 0) {
                        $('.Hunter-pop-up').remove();
                    }

                 },
                 selectRange: function(e){

                    monthStartDate=e.startDate.getMonth()+1;
                    monthEndDate=e.endDate.getMonth()+1;
                    var startDate = e.startDate.getDate()+"/"+ monthStartDate+"/"+e.startDate.getFullYear();
                    var endDate = e.endDate.getDate()+"/"+ monthEndDate+"/"+e.endDate.getFullYear();

                    swal.withFormAsync({
                        title: 'Richiesta ferie dal '+  startDate + ' al ' + endDate,
                        showCancelButton: true,
                        confirmButtonColor: '#DD6B55',
                        confirmButtonText: 'Ok',
                        cancelButtonText: 'annulla',
                        closeOnConfirm: false,
                        formFields: [

                            { id: 'titolo', label: 'Descrizione tipologia ferie (opzionale):', name: 'titolo', placeholder: 'descrizione ferie' },


                        ]
                    }).then(function (context) {
                        if(context._isConfirm){



                             //   saveEvent(e, context.swalForm['titolo']);



                                socketProfilo.emit('richiesta_ferie', {
                                    'dip': '{{dipendente.username}}',
                                    'titolo': context.swalForm['titolo'],
                                    'start_date': startDate,
                                    'end_date': endDate
                                });



                            swal({
                                title: "Richiesta inviata correttamente",
                                confirmButtonColor: '#DD6B55',
                                confirmButtonText: 'Ok',
                                closeOnConfirm: true
                            });

                        }

                    });

                 }
              }
            );

            //Elimina i popup se si esce dal calendario evitando di doverli chiudere a mano
            $('#menu-container').mouseout(function(){
                //Se il mouse e' sopra un popup element non elimina il popup
                if (!$('.Hunter-pop-up:hover').length != 0) {
                    $('.Hunter-pop-up').remove();
                }
            });

            /* Cliccando sui tag di classe ".editProfilo" si può modificare un campo "dati personali" del dipendente.
               Specificato il nuovo valore, viene inviato al server il segnale di effetture la modifica sul database e
               questo risponderà al client con un segnale "aggiornaPagina". Le due variabili che seguono vengono usate
               per aggiornare i campi specifici e non l'intera pagina */

            var nomeObjToChange = "#";
            var newValObjToChange ="";


            $('.editProfilo').click(function(){


                var campoToEdit = $(this).attr('class').split(' ')[3];
                var titolo = "";
                var label="";
                var campo ="";
                var valore ="";


                if( campoToEdit == 'nome_cognome' ){
                    titolo="Modifica nome e cognome";
                    label="";
                    swal.withFormAsync({
                            title: titolo,
                            showCancelButton: true,
                            confirmButtonColor: '#DD6B55',
                            confirmButtonText: 'Ok',
                            cancelButtonText: 'annulla',
                            closeOnConfirm: true,
                            formFields: [

                                { id: 'testo', label: label, name: 'testo', type: 'text', value: '{{dipendente.nome}} {{dipendente.cognome}}' },


                            ]
                        }).then(function (context) {
                            if(context._isConfirm){
                                 campo="nome_cognome";
                                 valore=context.swalForm['testo'];
                                 socketProfilo.emit('modifica_profilo', {
                                    'dip' : '{{dipendente.username}}',
                                    'campo': campo,
                                    'valore': valore
                                 });

                                 nomeObjToChange+=campo;
                                 newValObjToChange=valore;
                            }

                        });

                }
                else if( campoToEdit == 'cf' ){
                    titolo="Modifica codice fiscale";
                    label="Codice Fiscale:";
                    swal.withFormAsync({
                            title: titolo,
                            showCancelButton: true,
                            confirmButtonColor: '#DD6B55',
                            confirmButtonText: 'Ok',
                            cancelButtonText: 'annulla',
                            closeOnConfirm: true,
                            formFields: [

                                { id: 'testo', label: label, name: 'testo', type: 'text', value: '{{dipendente.cf}}' },


                            ]
                        }).then(function (context) {
                            if(context._isConfirm){
                                 campo="cf";
                                 valore=context.swalForm['testo'];
                                 socketProfilo.emit('modifica_profilo', {
                                    'dip' : '{{dipendente.username}}',
                                    'campo': campo,
                                    'valore': valore
                                 });

                                 nomeObjToChange+=campo;
                                 newValObjToChange=valore;

                            }

                        });

                }
                else if( campoToEdit == 'nascita' ){
                    titolo="Modifica data di nascita";
                    swal.withFormAsync({
                        title: titolo,
                        showCancelButton: true,
                        confirmButtonColor: '#DD6B55',
                        confirmButtonText: 'Ok',
                        cancelButtonText: 'annulla',
                        closeOnConfirm: true,
                        formFields: [

                            { id: 'nascita', label: 'Data di nascita: ', name: 'nascita', type: 'date', value: '{{dipendente.dataNascita}}' },


                        ]
                    }).then(function (context) {
                        if(context._isConfirm){
                             campo="dataNascita";
                             valore=context.swalForm['nascita'];

                             socketProfilo.emit('modifica_profilo', {
                                    'dip' : '{{dipendente.username}}',
                                    'campo': campo,
                                    'valore': valore
                             });

                             nomeObjToChange+='nascita';
                             newValObjToChange=valore;

                        }

                    });
                }
                else if( campoToEdit == 'residenza' ){
                    titolo="Modifica luogo di residenza";
                    label="Residenza:";
                    swal.withFormAsync({
                            title: titolo,
                            showCancelButton: true,
                            confirmButtonColor: '#DD6B55',
                            confirmButtonText: 'Ok',
                            cancelButtonText: 'annulla',
                            closeOnConfirm: true,
                            formFields: [

                                { id: 'via', label: 'VIA', name: 'testo', type: 'text', value: '{{dipendente.residenzaVia}}' },
                                { id: 'num', label: 'NUMERO', name: 'testo', type: 'number', value: '{{dipendente.residenzaNum}}' },
                                { id: 'citta', label: 'CITTÀ', name: 'testo', type: 'text', value: '{{dipendente.residenzaCitta}}' },
                                { id: 'regione', label: 'REGIONE', name: 'testo', type: 'text', value: '{{dipendente.residenzaRegione}}' },


                            ]
                        }).then(function (context) {
                            if(context._isConfirm){
                                 campo="residenza";
                                 via=context.swalForm['via'];
                                 num=context.swalForm['num'];
                                 citta=context.swalForm['citta'];
                                 regione=context.swalForm['regione'];

                                 socketProfilo.emit('modifica_indirizzo_profilo', {
                                    'dip' : '{{dipendente.username}}',
                                    'campo': campo,
                                    'via': via,
                                    'num': num,
                                    'citta': citta,
                                    'regione': regione
                                 });

                                 nomeObjToChange+=campo;
                                 newValObjToChange=via+' num.'+num+', '+citta+', '+regione;;

                            }

                        });

                }
                else if( campoToEdit == 'domicilio' ){
                    titolo="Modifica luogo di domicilio";
                    label="Domicilio:";
                    swal.withFormAsync({
                            title: titolo,
                            showCancelButton: true,
                            confirmButtonColor: '#DD6B55',
                            confirmButtonText: 'Ok',
                            cancelButtonText: 'annulla',
                            closeOnConfirm: true,
                            formFields: [

                                { id: 'via', label: 'VIA', name: 'testo', type: 'text', value: '{{dipendente.domicilioVia}}' },
                                { id: 'num', label: 'NUMERO', name: 'testo', type: 'number', value: '{{dipendente.domicilioNum}}' },
                                { id: 'citta', label: 'CITTÀ', name: 'testo', type: 'text', value: '{{dipendente.domicilioCitta}}' },
                                { id: 'regione', label: 'REGIONE', name: 'testo', type: 'text', value: '{{dipendente.domicilioRegione}}' },


                            ]
                        }).then(function (context) {
                            if(context._isConfirm){
                                 campo="domicilio";
                                 via=context.swalForm['via'];
                                 num=context.swalForm['num'];
                                 citta=context.swalForm['citta'];
                                 regione=context.swalForm['regione'];

                                 socketProfilo.emit('modifica_indirizzo_profilo', {
                                    'dip' : '{{dipendente.username}}',
                                    'campo': campo,
                                    'via': via,
                                    'num': num,
                                    'citta': citta,
                                    'regione': regione
                                 });

                                 nomeObjToChange+=campo;
                                 newValObjToChange=via+' num.'+num+', '+citta+', '+regione;

                            }

                        });

                }
                else if( campoToEdit == 'email_aziendale' ){
                    titolo="Modifica email aziendale";
                    label="Email:";
                    swal.withFormAsync({
                            title: titolo,
                            showCancelButton: true,
                            confirmButtonColor: '#DD6B55',
                            confirmButtonText: 'Ok',
                            cancelButtonText: 'annulla',
                            closeOnConfirm: true,
                            formFields: [

                                { id: 'testo', label: label, name: 'testo', type: 'text', value: '{{dipendente.email_aziendale}}' },


                            ]
                        }).then(function (context) {
                            if(context._isConfirm){
                                 campo="email_aziendale";
                                 valore=context.swalForm['testo'];

                                 socketProfilo.emit('modifica_profilo', {
                                    'dip' : '{{dipendente.username}}',
                                    'campo': campo,
                                    'valore': valore
                                 });

                                 nomeObjToChange+=campo;
                                 newValObjToChange=valore;

                            }

                        });

                }
                else if( campoToEdit == 'email_personale' ){
                    titolo="Modifica email personale";
                    label="Email:";
                    swal.withFormAsync({
                            title: titolo,
                            showCancelButton: true,
                            confirmButtonColor: '#DD6B55',
                            confirmButtonText: 'Ok',
                            cancelButtonText: 'annulla',
                            closeOnConfirm: true,
                            formFields: [

                                { id: 'testo', label: label, name: 'testo', type: 'text', value: '{{dipendente.email_personale}}' },


                            ]
                        }).then(function (context) {
                            if(context._isConfirm){
                                 campo="email_personale";
                                 valore=context.swalForm['testo'];

                                 socketProfilo.emit('modifica_profilo', {
                                    'dip' : '{{dipendente.username}}',
                                    'campo': campo,
                                    'valore': valore
                                 });

                                 nomeObjToChange+=campo;
                                 newValObjToChange=valore;

                            }

                        });

                }
                else if( campoToEdit == 'telefono' ){
                    titolo="Modifica telefono";
                    label="Telefono: ";
                    swal.withFormAsync({
                            title: titolo,
                            showCancelButton: true,
                            confirmButtonColor: '#DD6B55',
                            confirmButtonText: 'Ok',
                            cancelButtonText: 'annulla',
                            closeOnConfirm: true,
                            formFields: [

                                { id: 'testo', label: label, name: 'testo', type: 'text', value: '{{dipendente.telefono}}' },


                            ]
                        }).then(function (context) {
                            if(context._isConfirm){
                                 campo="telefono";
                                 valore=context.swalForm['testo'];

                                 socketProfilo.emit('modifica_profilo', {
                                    'dip' : '{{dipendente.username}}',
                                    'campo': campo,
                                    'valore': valore
                                 });

                                 nomeObjToChange+=campo;
                                 newValObjToChange=valore;

                            }

                        });

                }
                else if( campoToEdit == 'iban' ){
                    titolo="Modifica iban";
                    label="IBAN:";
                    swal.withFormAsync({
                            title: titolo,
                            showCancelButton: true,
                            confirmButtonColor: '#DD6B55',
                            confirmButtonText: 'Ok',
                            cancelButtonText: 'annulla',
                            closeOnConfirm: true,
                            formFields: [

                                { id: 'testo', label: label, name: 'testo', type: 'text', value: '{{dipendente.iban}}' },


                            ]
                        }).then(function (context) {
                            if(context._isConfirm){
                                 campo="iban";
                                 valore=context.swalForm['testo'];

                                 socketProfilo.emit('modifica_profilo', {
                                    'dip' : '{{dipendente.username}}',
                                    'campo': campo,
                                    'valore': valore
                                 });

                                 nomeObjToChange+=campo;
                                 newValObjToChange=valore;

                            }

                        });

                }
                else if( campoToEdit == 'iva' ){
                    titolo="Modifica partita IVA";
                    label="Partita IVA:";
                    swal.withFormAsync({
                            title: titolo,
                            showCancelButton: true,
                            confirmButtonColor: '#DD6B55',
                            confirmButtonText: 'Ok',
                            cancelButtonText: 'annulla',
                            closeOnConfirm: true,
                            formFields: [

                                { id: 'testo', label: label, name: 'testo', type: 'text', value: '{{dipendente.iva}}' },


                            ]
                        }).then(function (context) {
                            if(context._isConfirm){
                                 campo="partitaIva";
                                 valore=context.swalForm['testo'];

                                 socketProfilo.emit('modifica_profilo', {
                                    'dip' : '{{dipendente.username}}',
                                    'campo': campo,
                                    'valore': valore
                                 });

                                 nomeObjToChange+='iva';
                                 newValObjToChange=valore;

                            }

                        });

                }




            });

            socketProfilo.on('aggiorna_pagina', function(){
                // window.location ="{{url_for('paginaProfilo')}}"

                if( eliminaFerieAttiva ){

                    window.location ="{{url_for('paginaProfilo')}}"
                    eliminaFerieAttiva=false;
                }
                else if( modificaFerieAttiva ){

                    window.location ="{{url_for('paginaProfilo')}}"
                    modificaFerieAttiva=false;
                }
                else{
                    $(nomeObjToChange).text(newValObjToChange);
                    nomeObjToChange='#';
                    newValObjToChange='';

                }
            });

		</script>

	</div>
	</body>
</html>